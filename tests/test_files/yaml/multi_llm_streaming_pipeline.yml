components:
  prompt_1:
    init_parameters:
      required_variables: "*"
      template: |
        "Answer this question: {{query}}
        Answer:
        "
    type: haystack.components.builders.prompt_builder.PromptBuilder

  llm_1:
    init_parameters:
      api_base_url: null
      api_key:
        env_vars:
          - OPENAI_API_KEY
        strict: true
        type: env_var
      generation_kwargs: {}
      model: gpt-4o-mini
      streaming_callback: null
      system_prompt: null
    type: haystack.components.generators.openai.OpenAIGenerator

  prompt_2:
    init_parameters:
      required_variables: "*"
      template: |
        "Refine this response: {{previous_reply}}
        Improved answer:
        "
    type: haystack.components.builders.prompt_builder.PromptBuilder

  llm_2:
    init_parameters:
      api_base_url: null
      api_key:
        env_vars:
          - OPENAI_API_KEY
        strict: true
        type: env_var
      generation_kwargs: {}
      model: gpt-4o-mini
      streaming_callback: null
      system_prompt: null
    type: haystack.components.generators.openai.OpenAIGenerator

connections:
  - receiver: llm_1.prompt
    sender: prompt_1.prompt
  - receiver: prompt_2.previous_reply
    sender: llm_1.replies
  - receiver: llm_2.prompt
    sender: prompt_2.prompt

metadata: {}

inputs:
  query: prompt_1.query

outputs:
  replies: llm_2.replies

streaming_components:
  llm_1: true
  llm_2: true
